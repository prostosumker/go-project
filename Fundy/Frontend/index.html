<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Fundy</title>

		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Advent+Pro:ital,wght@0,100..900;1,100..900&family=Jost:ital,wght@0,100..900;1,100..900&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
			rel="stylesheet"
		/>

		<link rel="icon" href="../Frontend/media/Logo.ico" type="image/x-icon" />

		<style>
			#reportChart {
				width: 270px;
				height: 270px;
			}
			.modal {
				display: flex;
				justify-content: center;
				align-items: center;
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.5);
			}

			.modal-content {
				background-color: #fff;
				border-radius: 8px;
				width: 400px;
				padding: 20px;
				display: flex;
				flex-direction: column;
				gap: 10px;
			}

			.category-dropdown {
				width: 100%;
				padding: 8px;
				margin-bottom: 10px;
				border: 1px solid #ccc;
				border-radius: 4px;
			}

			.modal-body {
				flex: 1;
			}

			.save-button {
				margin-top: 10px;
				width: 100%;
				padding: 12px;
				background-color: #4caf50;
				color: white;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-size: 16px;
			}

			.save-button:hover {
				background-color: #45a049;
			}
			.modal-contentExp,
			.modal-contentInc {
				background-color: #ffffff;
				margin: 15% auto;
				padding: 20px;
				border: none;
				border-radius: 10px;
				box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
				width: 400px;
				max-width: 90%;
				text-align: center;
			}
			@keyframes fadeIn {
				from {
					opacity: 0;
					transform: translateY(-20px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}
			.modal-contentExp,
			.modal-contentInc {
				animation: fadeIn 0.3s ease-out;
			}
			.ubuntu-medium {
				font-family: 'Ubuntu', sans-serif;
				font-weight: 500;
				font-style: normal;
			}
			body {
				font-family: 'Ubuntu';
				margin: 0;
				padding: 0;
				background-color: #f5f5f5;
			}

			.header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 20px;
				background-color: #fff;
				border-bottom: 1px solid #ddd;
			}

			.header .logo {
				font-size: 24px;
				font-weight: bold;
				color: #000;
				font-family: 'Ubuntu';
			}

			.container {
				display: grid;
				grid-template-columns: 1fr 2fr 1fr;
				gap: 20px;
				padding: 20px;
			}

			.balance-card {
				grid-column: 2;
				background-color: #fff;
				border-radius: 8px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				padding: 20px;
				text-align: center;
			}

			.balance-card h2 {
				font-size: 18px;
				color: #555;
			}

			.balance-card .balance {
				font-size: 36px;
				font-weight: bold;
				margin: 10px 0;
				color: #000;
			}

			.balance-card .currency {
				display: flex;
				justify-content: flex-end;
				font-size: 14px;
				color: #777;
			}

			.report-section {
				grid-column: 2;
				background-color: #fff;
				border-radius: 8px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				padding: 20px;
				margin-top: 20px;
			}

			.report-section .tabs {
				display: flexbox;
				gap: 10px;
			}

			.report-section .tabs button {
				padding: 10px 20px;
				border: none;
				border-radius: 5px;
				cursor: pointer;
				background-color: #000;
				color: #fff;
				font-weight: bold;
			}

			.report-section .tabs button.inactive {
				background-color: #ddd;
				border-radius: 20px;
			}

			.report-section .tabs button.inactive:active {
				background-color: #000000;
				color: #ffffff;
				border-radius: 20px;
			}

			.report-section .tabs button.inactive:focus {
				background-color: #000000;
				color: #ffffff;
				border-radius: 20px;
			}

			.report-section .chart {
				margin-top: 20px;
				text-align: center;
			}

			.buttons {
				grid-column: 2;
				display: flex;
				justify-content: space-between;
				margin-top: 20px;
			}

			.buttons button {
				padding: 15px 30px;
				border: none;
				border-radius: 5px;
				font-size: 16px;
				font-weight: bold;
				cursor: pointer;
			}

			.buttons .expense {
				background: linear-gradient(90deg, #800000, #ff0000);
				color: #fff;
				padding-left: 100px;
				padding-right: 100px;
				padding-top: 50px;
				padding-bottom: 50px;
			}

			.buttons .income {
				background: linear-gradient(90deg, #004d40, #00e676);
				color: #fff;
				padding-left: 100px;
				padding-right: 100px;
				padding-top: 50px;
				padding-bottom: 50px;
			}
			.modalExp {
				display: none;
				position: fixed;
				z-index: 1;
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				overflow: auto;
				background-color: rgb(0, 0, 0);
				background-color: rgba(0, 0, 0, 0.295);
			}
			.modal-contentExp {
				background-color: #fefefe;
				margin: 15% auto;
				padding: 20px;
				border: 1px solid #888;
				width: 80%;
			}
			.closeExp {
				background: none;
				color: inherit;
				border: none;
				padding: 0;
				font: inherit;
				cursor: pointer;
				outline: inherit;
				color: #aaa;
				float: right;
				font-size: 28px;
				font-weight: bold;
				background-color: #88888800;
				border-color: white;
			}
			.closeExp:hover,
			.closeExp:focus {
				color: black;
				text-decoration: none;
				cursor: pointer;
			}

			.modalInc {
				display: none;
				position: fixed;
				z-index: 1;
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				overflow: auto;
				background-color: rgb(0, 0, 0);
				background-color: rgba(0, 0, 0, 0.295);
			}
			.modal-contentInc {
				background-color: #fefefe;
				margin: 15% auto;
				padding: 20px;
				border: 1px solid #888;
				width: 80%;
			}
			.closeInc {
				background: none;
				color: inherit;
				border: none;
				padding: 0;
				font: inherit;
				cursor: pointer;
				outline: inherit;
				color: #aaa;
				float: right;
				font-size: 28px;
				font-weight: bold;
				background-color: #88888800;
				border-color: white;
			}
			.closeInc:hover,
			.closeInc:focus {
				color: black;
				text-decoration: none;
				cursor: pointer;
			}
			.container {
				font-family: 'Arial';
			}
		</style>
	</head>
	<body>
		<header class="header">
			<div class="logo">FUNDY</div>
			<div class="profile">
				<img
					src="..//Frontend/media/UserIcon.jpg"
					alt=""
					width="30px"
					height="30px"
				/>
			</div>
		</header>

		<div id="myModalExp" class="modalExp">
			<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ -->
			<div class="modal-contentExp">
				<!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è -->
				<button class="closeExp" id="closeExp">&times;</button>

				<!-- –í–≤–æ–¥ —Å—É–º–º—ã -->
				<p style="font-size: 18px; margin-bottom: 10px">–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É:</p>
				<input
					type="text"
					id="amountInputExp"
					placeholder="‚ÇΩ0.00"
					style="
						width: 100%;
						padding: 10px;
						border: 1px solid #ddd;
						border-radius: 5px;
						font-size: 16px;
						box-sizing: border-box;
					"
				/>
				<!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
				<label
					for="categorySelectExp"
					style="font-size: 16px; margin-bottom: 10px; display: block"
				>
					–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ä–∞—Å—Ö–æ–¥–∞:
				</label>
				<select
					id="categorySelectExp"
					style="
						width: 100%;
						padding: 10px;
						margin-bottom: 20px;
						border: 1px solid #ddd;
						border-radius: 5px;
						font-size: 14px;
					"
				>
					<option value="food">üçï–ï–¥–∞</option>
					<option value="entertainment">üéâ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
					<option value="rent">üè† –ê—Ä–µ–Ω–¥–∞</option>
					<option value="mortgage">üèõÔ∏è –ò–ø–æ—Ç–µ–∫–∞</option>
					<option value="clothes">üëî –û–¥–µ–∂–¥–∞</option>
					<option value="beauty">‚ú® –ö—Ä–∞—Å–æ—Ç–∞</option>
					<option value="investment">üí∏ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</option>
					<option value="otherExp">–î—Ä—É–≥–æ–µ</option>
				</select>

				<!-- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–Ω–∏–∑—É -->
				<button
					id="saveButtonExp"
					style="
						width: 100%;
						padding: 12px;
						background-color: #4caf50;
						color: white;
						border: none;
						border-radius: 5px;
						font-weight: bold;
						font-size: 16px;
						cursor: pointer;
					"
				>
					–°–æ—Ö—Ä–∞–Ω–∏—Ç—å
				</button>
			</div>
		</div>

		<div id="myModalInc" class="modalInc">
			<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ -->
			<div class="modal-contentInc">
				<!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è -->
				<button class="closeInc" id="closeInc">&times;</button>

				<!-- –í–≤–æ–¥ —Å—É–º–º—ã -->
				<p style="font-size: 18px; margin-bottom: 10px">–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É:</p>
				<input
					type="text"
					id="amountInputInc"
					placeholder="‚ÇΩ0.00"
					style="
						width: 100%;
						padding: 10px;
						border: 1px solid #ddd;
						border-radius: 5px;
						font-size: 16px;
						box-sizing: border-box;
					"
				/>
				<!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
				<label
					for="categorySelectInc"
					style="font-size: 16px; margin-bottom: 10px; display: block"
				>
					–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ—Ö–æ–¥–∞:
				</label>
				<select
					id="categorySelectInc"
					style="
						width: 100%;
						padding: 10px;
						margin-bottom: 20px;
						border: 1px solid #ddd;
						border-radius: 5px;
						font-size: 14px;
					"
				>
					<option value="scholarship">üéì–°—Ç–∏–ø–µ–Ω–¥–∏—è</option>
					<option value="paycheck">üíµ –ó–∞—Ä. –ø–ª–∞—Ç–∞</option>
					<option value="dividendts">üìà –î–∏–≤–∏–¥–µ–Ω–¥—ã</option>
					<option value="deposit">üí≥ –ü—Ä–æ—Ü–µ–Ω—Ç—ã –ø–æ –¥–µ–ø–æ–∑–∏—Ç—É</option>
					<option value="otherInc">–î—Ä—É–≥–æ–µ</option>
				</select>

				<!-- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–Ω–∏–∑—É -->
				<button
					id="saveButtonInc"
					style="
						width: 100%;
						padding: 12px;
						background-color: #4caf50;
						color: white;
						border: none;
						border-radius: 5px;
						font-weight: bold;
						font-size: 16px;
						cursor: pointer;
					"
				>
					–°–æ—Ö—Ä–∞–Ω–∏—Ç—å
				</button>
			</div>
		</div>

		<div class="container">
			<div class="balance-card">
				<h2>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</h2>
				<div id="balance" class="balance">‚ÇΩ0.0</div>
				<div class="currency">RUB</div>
			</div>

			<div class="report-section">
				<h3 id="reportMonth">–û—Ç—á—ë—Ç –∑–∞</h3>
				<div class="tabs">
					<button
						style="background-color: #000000; color: #ffffff"
						id="btnDiagrExp"
						class="inactive"
					>
						–¢—Ä–∞—Ç—ã
					</button>
					<button style="color: #555" id="btnDiagrInc" class="inactive">
						–ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è
					</button>
					<div width="200" height="200" class="chart">
						<canvas style="display: block" id="reportChartExp"></canvas>
						<canvas style="display: none" id="reportChartInc"></canvas>
					</div>
				</div>
			</div>
			<div class="buttons">
				<button id="myBtnExp" class="expense">+ –¢—Ä–∞—Ç–∞</button>
				<button id="myBtnInc" class="income">+ –î–æ—Ö–æ–¥</button>
			</div>
		</div>
	</body>
</html>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
	function getToDaysMonth() {
		let currentDate = new Date()
		const monthName = currentDate.toLocaleString('default', { month: 'long' })

		reportMonthTextEl = document.getElementById('reportMonth')
		switch (monthName) {
			case 'January':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –Ø–Ω–≤–∞—Ä—å'
				break
			case 'February':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –§–µ–≤—Ä–∞–ª—å'
				break
			case 'March':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –ú–∞—Ä—Ç'
				break
			case 'April':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –ê–ø—Ä–µ–ª—å'
				break
			case 'May':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –ú–∞–π'
				break
			case 'June':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –ò—é–Ω—å'
				break
			case 'July':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –ò—é–ª—å'
				break
			case 'August':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –ê–≤–≥—É—Å—Ç'
				break
			case 'September':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –°–µ–Ω—Ç—è–±—Ä—å'
				break
			case 'October':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –û–∫—Ç—è–±—Ä—å'
				break
			case 'November':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –ù–æ—è–±—Ä—å'
				break
			case 'December':
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –î–µ–∫–∞–±—Ä—å'
				break
			default:
				reportMonthTextEl.textContent = '–û—Ç—á—ë—Ç –∑–∞ –º–µ—Å—è—Ü'
				break
		}
	}

	//–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º—ã –∑–Ω–∞—á–µ–Ω–∏–π –¥–∏–∞–≥—Ä–∞–º–º—ã
	function getChartDataSum(chart) {
		return chart.data.datasets[0].data.reduce((acc, value) => acc + value, 0)
	}

	//–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
	getToDaysMonth()

	// –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–≥—Ä–∞–º–º–∞–º–∏
	var btnDiagrExp = document.getElementById('btnDiagrExp')
	var btnDiagrInc = document.getElementById('btnDiagrInc')

	var canvasInc = document.getElementById('reportChartInc')
	var canvasExp = document.getElementById('reportChartExp')

	let reportChartExp // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞—Å—Ö–æ–¥–æ–≤
	let reportChartInc // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–æ—Ö–æ–¥–æ–≤

	// –î–∏–∞–≥—Ä–∞–º–º–∞
	function createChart(context, type, data, options) {
		return new Chart(context, {
			type: type,
			data: data,
			options: options,
		})
	}

	// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Ö–æ–¥–∞—Ö
	var incDataArray = [0, 0, 0, 0, 0]
	console.log("–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö", incDataArray)
	// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞—Å—Ö–æ–¥–∞—Ö
	var expDataArray = [0, 0, 0, 0, 0, 0, 0, 0]
	console.log("–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö", expDataArray)
	async function downloadData() {
		console.log("–ó–∞–ø—É—Å–∫ –ø–æ–¥–≥—Ä—É–∑–∫–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö")
		const response = await fetch('/downloadingData', {
                  method: 'GET',
                  credentials: 'include', // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ cookies
                });
		if (response.ok) {
			console.log("–ö–æ–ø–∏—Ä—É—é –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ")
			data = await response.json()
			for (let i = 0; i < 5; i++) {
				incDataArray[i] = data.outIncArray[i];
			}
			for (let i = 0; i < 8; i++) {
				expDataArray[i] = data.outExpArray[i];
			}
			console.log(expDataArray)
			console.log(incDataArray)
			console.log(data)
		}
		
	}


	async function uploadingData() {
		var data = {
    			inpExpArray: [0, 0, 0, 0, 0, 0, 0, 0], // –º–∞—Å—Å–∏–≤ —Ä–∞—Å—Ö–æ–¥–æ–≤
    			inpIncArray: [0, 0, 0, 0, 0]          // –º–∞—Å—Å–∏–≤ –¥–æ—Ö–æ–¥–æ–≤
		};
		data.inpIncArray = incDataArray;
		data.inpExpArray = expDataArray;
		const response = await fetch("http://localhost:8181/uploadingData", {
                method: "POST",
				credentials:'include',
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            });
		if (response.ok) {
			data = await response.json()
			for (let i = 0; i < 5; i++) {
				incDataArray[i] = data.outIncArray[i];
			}
			for (let i = 0; i < 8; i++) {
				expDataArray[i] = data.outExpArray[i];
			}
		}
		
	}

	// –î–∞–Ω–Ω—ã–µ –∏ –æ–ø—Ü–∏–∏ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º
	const expData = {
		labels: [
			'–ï–¥–∞',
			'–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è',
			'–ò–ø–æ—Ç–µ–∫–∞',
			'–ê—Ä–µ–Ω–¥–∞',
			'–û–¥–µ–∂–¥–∞',
			'–ö—Ä–∞—Å–æ—Ç–∞',
			'–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏',
			'–î—Ä—É–≥–æ–µ',
		],
		datasets: [
			{
				label: '–†–∞—Å—Ö–æ–¥—ã',
				data: expDataArray,
				backgroundColor: [
					'#e60049',
					'#0bb4ff',
					'#50e991',
					'#e6d800',
					'#9b19f5',
					'#ffa300',
					'#dc0ab4',
					'#b3d4ff',
					'#00bfa0',
				],
				borderWidth: 10,
				hoverOffset: 10,
			},
		],
	}

	const incData = {
		labels: [
			'–°—Ç–∏–ø–µ–Ω–¥–∏—è',
			'–ó–∞—Ä–ø–ª–∞—Ç–∞',
			'–î–∏–≤–∏–¥–µ–Ω–¥—ã',
			'–ü—Ä–æ—Ü–µ–Ω—Ç—ã –ø–æ –¥–µ–ø–æ–∑–∏—Ç—É',
			'–î—Ä—É–≥–æ–µ',
		],
		datasets: [
			{
				label: '–î–æ—Ö–æ–¥—ã',
				data: incDataArray,
				backgroundColor: [
					'#33FF70',
					'#33A0FF',
					'#bc13fe',
					'#f80000',
					'#ffea19',
					'#7df9ff',
				],
				borderWidth: 10,
				hoverOffset: 10,
			},
		],
	}

	const chartOptions = {
		responsive: true,
		animation: {
			duration: 1000,
		},
		plugins: {
			legend: {
				display: true,
			},
			tooltip: {
				enabled: true,
				callbacks: {
					label: function (context) {
						const value = context.raw
						return `‚ÇΩ${value}`
					},
				},
				displayColors: false,
			},
		},
		elements: {
			arc: {
				borderRadius: 100,
			},
		},
		cutout: '60%',
		maintainAspectRatio: false,
	}

	// –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
	canvasInc.style.display = 'none'
	reportChartExp = createChart(
		canvasExp.getContext('2d'),
		'doughnut',
		expData,
		chartOptions
	)

	// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞—Å—Ö–æ–¥–æ–≤
	btnDiagrExp.onclick = function () {
		if (reportChartInc) {
			reportChartInc.destroy()
		}
		canvasExp.style.display = 'block'
		canvasInc.style.display = 'none'

		btnDiagrExp.style.color = '#ffffff'
		btnDiagrInc.style.color = '#555'

		btnDiagrExp.style.background = '#000000'
		btnDiagrInc.style.background = '#ddd'

		reportChartExp = createChart(
			canvasExp.getContext('2d'),
			'doughnut',
			expData,
			chartOptions
		)
	}

	// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º—É –¥–æ—Ö–æ–¥–æ–≤
	btnDiagrInc.onclick = function () {
		if (reportChartExp) {
			reportChartExp.destroy()
		}
		canvasExp.style.display = 'none'
		canvasInc.style.display = 'block'

		btnDiagrInc.style.color = '#ffffff'
		btnDiagrExp.style.color = '#555'

		btnDiagrInc.style.background = '#000000'
		btnDiagrExp.style.background = '#ddd'

		reportChartInc = createChart(
			canvasInc.getContext('2d'),
			'doughnut',
			incData,
			chartOptions
		)
	}

	//–†—É–±–ª–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ —Ä–∞—Å—Ö–æ–¥–æ–≤
	const amountInputExp = document.getElementById('amountInputExp')

	amountInputExp.addEventListener('input', function (e) {
		// –£–±–∏—Ä–∞–µ–º –≤—Å—ë, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä –∏ —Ç–æ—á–∫–∏
		let value = e.target.value.replace(/[^\d.]/g, '')

		// –î–æ–±–∞–≤–ª—è–µ–º ‚ÇΩ –≤ –Ω–∞—á–∞–ª–æ —Ç–µ–∫—Å—Ç–∞
		e.target.value = value ? `‚ÇΩ${value}` : ''
	})

	// –î–æ–±–∞–≤–ª—è–µ–º ‚ÇΩ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
	amountInputExp.addEventListener('focus', function () {
		if (!amountInputExp.value.startsWith('‚ÇΩ')) {
			amountInputExp.value = '‚ÇΩ'
		}
	})

	//–†—É–±–ª–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –¥–æ—Ö–æ–¥–æ–≤
	const amountInputInc = document.getElementById('amountInputInc')

	amountInputInc.addEventListener('input', function (e) {
		// –£–±–∏—Ä–∞–µ–º –≤—Å—ë, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä –∏ —Ç–æ—á–∫–∏
		let value = e.target.value.replace(/[^\d.]/g, '')

		// –î–æ–±–∞–≤–ª—è–µ–º ‚ÇΩ –≤ –Ω–∞—á–∞–ª–æ —Ç–µ–∫—Å—Ç–∞
		e.target.value = value ? `‚ÇΩ${value}` : ''
	})

	// –î–æ–±–∞–≤–ª—è–µ–º ‚ÇΩ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
	amountInputInc.addEventListener('focus', function () {
		if (!amountInputInc.value.startsWith('‚ÇΩ')) {
			amountInputInc.value = '‚ÇΩ'
		}
	})

	// –ü–æ–ª—É—á–∏—Ç—å –º–æ–¥–∞–ª—å–Ω—ã–π
	var modalExp = document.getElementById('myModalExp')
	// –ü–æ–ª—É—á–∏—Ç—å –∫–Ω–æ–ø–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω—ã–π
	var btnExp = document.getElementById('myBtnExp')
	// –ü–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç <span>, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω—ã–π
	var spanExp = document.getElementById('closeExp')
	// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –∫–Ω–æ–ø–∫—É, –æ—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω—ã–π
	btnExp.onclick = function () {
		modalExp.style.display = 'block'
	}
	// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ <span> (x), –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
	spanExp.onclick = function () {
		modalExp.style.display = 'none'
	}
	// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —â—ë–ª–∫–∞–µ—Ç –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ, –∑–∞–∫—Ä—ã—Ç—å –µ–≥–æ

	var modalInc = document.getElementById('myModalInc')
	// –ü–æ–ª—É—á–∏—Ç—å –∫–Ω–æ–ø–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω—ã–π
	var btnInc = document.getElementById('myBtnInc')
	// –ü–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç <span>, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω—ã–π
	var spanInc = document.getElementById('closeInc')
	// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –∫–Ω–æ–ø–∫—É, –æ—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω—ã–π
	btnInc.onclick = function () {
		modalInc.style.display = 'block'
	}
	// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ <span> (x), –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
	spanInc.onclick = function () {
		modalInc.style.display = 'none'
	}
	window.onclick = function (event) {
		if ((event.target == modalExp) | (event.target == modalInc)) {
			modalExp.style.display = 'none'
			modalInc.style.display = 'none'
		}
	}

	//–ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –¥–æ—Ö–æ–¥–∞
	var saveButtonInc = document.getElementById('saveButtonInc')

	saveButtonInc.onclick = function () {
		var amountInputIncPlace = document.getElementById('amountInputInc')
		var categorySelectInc = document.getElementById('categorySelectInc')

		var valueCategoryInc = categorySelectInc.value
		var inputValueInc = amountInputIncPlace.value
		if ((inputValueInc == '') | (parseFloat(inputValueInc.slice(1)) < 0.0001)) {
			alert('–í—ã –Ω–µ –≤–≤–µ–ª–∏ –Ω–∏—á–µ–≥–æ!')
		} else {
			switch (valueCategoryInc) {
				case 'scholarship':
					incDataArray[0] = incDataArray[0] + parseFloat(inputValueInc.slice(1))
					modalInc.style.display = 'none'
					if (reportChartInc) {
						reportChartInc.destroy()
					}
					if (canvasInc.style.display == 'block') {
						reportChartInc = createChart(
							canvasInc.getContext('2d'),
							'doughnut',
							incData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'paycheck':
					incDataArray[1] = incDataArray[1] + parseFloat(inputValueInc.slice(1))
					amountInputIncPlace.value = ''
					modalInc.style.display = 'none'
					if (reportChartInc) {
						reportChartInc.destroy()
					}
					if (canvasInc.style.display == 'block') {
						reportChartInc = createChart(
							canvasInc.getContext('2d'),
							'doughnut',
							incData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'dividendts':
					incDataArray[2] = incDataArray[2] + parseFloat(inputValueInc.slice(1))
					amountInputIncPlace.value = ''
					modalInc.style.display = 'none'
					if (reportChartInc) {
						reportChartInc.destroy()
					}
					if (canvasInc.style.display == 'block') {
						reportChartInc = createChart(
							canvasInc.getContext('2d'),
							'doughnut',
							incData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'deposit':
					incDataArray[3] = incDataArray[3] + parseFloat(inputValueInc.slice(1))
					amountInputIncPlace.value = ''
					modalInc.style.display = 'none'
					if (reportChartInc) {
						reportChartInc.destroy()
					}
					if (canvasInc.style.display == 'block') {
						reportChartInc = createChart(
							canvasInc.getContext('2d'),
							'doughnut',
							incData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'otherInc':
					incDataArray[4] = incDataArray[4] + parseFloat(inputValueInc.slice(1))
					amountInputIncPlace.value = ''
					modalInc.style.display = 'none'
					if (reportChartInc) {
						reportChartInc.destroy()
					}
					if (canvasInc.style.display == 'block') {
						reportChartInc = createChart(
							canvasInc.getContext('2d'),
							'doughnut',
							incData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
			}
			uploadingData()
		}
	}

	//–ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞
	var saveButtonExp = document.getElementById('saveButtonExp')

	saveButtonExp.onclick = function () {
		var amountInputExpPlace = document.getElementById('amountInputExp')
		var categorySelectExp = document.getElementById('categorySelectExp')

		var valueCategoryExp = categorySelectExp.value
		var inputValueExp = amountInputExpPlace.value
		if ((inputValueExp == '') | (parseFloat(inputValueExp.slice(1)) < 0.0001)) {
			alert('–í—ã –Ω–µ –≤–≤–µ–ª–∏ –Ω–∏—á–µ–≥–æ!')
		} else {
			switch (valueCategoryExp) {
				case 'food':
					expDataArray[0] = expDataArray[0] + parseFloat(inputValueExp.slice(1))
					modalExp.style.display = 'none'
					if (reportChartExp) {
						reportChartExp.destroy()
					}
					if (canvasExp.style.display == 'block') {
						reportChartExp = createChart(
							canvasExp.getContext('2d'),
							'doughnut',
							expData,
							chartOptions
						)
					}

					updateBalance(getIncSum(), getExpSum())
					break
				case 'entertainment':
					expDataArray[1] = expDataArray[1] + parseFloat(inputValueExp.slice(1))
					amountInputExpPlace.value = ''
					modalExp.style.display = 'none'
					if (reportChartExp) {
						reportChartExp.destroy()
					}
					if (canvasExp.style.display == 'block') {
						reportChartExp = createChart(
							canvasExp.getContext('2d'),
							'doughnut',
							expData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'rent':
					expDataArray[2] = expDataArray[2] + parseFloat(inputValueExp.slice(1))
					amountInputExpPlace.value = ''
					modalExp.style.display = 'none'
					if (reportChartExp) {
						reportChartExp.destroy()
					}
					if (canvasExp.style.display == 'block') {
						reportChartExp = createChart(
							canvasExp.getContext('2d'),
							'doughnut',
							expData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'mortgage':
					expDataArray[3] = expDataArray[3] + parseFloat(inputValueExp.slice(1))
					amountInputExpPlace.value = ''
					modalExp.style.display = 'none'
					if (reportChartExp) {
						reportChartExp.destroy()
					}
					if (canvasExp.style.display == 'block') {
						reportChartExp = createChart(
							canvasExp.getContext('2d'),
							'doughnut',
							expData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'clothes':
					expDataArray[4] = expDataArray[4] + parseFloat(inputValueExp.slice(1))
					amountInputExpPlace.value = ''
					modalExp.style.display = 'none'
					if (reportChartExp) {
						reportChartExp.destroy()
					}
					if (canvasExp.style.display == 'block') {
						reportChartExp = createChart(
							canvasExp.getContext('2d'),
							'doughnut',
							expData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'beauty':
					expDataArray[5] = expDataArray[5] + parseFloat(inputValueExp.slice(1))
					amountInputExpPlace.value = ''
					modalExp.style.display = 'none'
					if (reportChartExp) {
						reportChartExp.destroy()
					}

					if (canvasExp.style.display == 'block') {
						reportChartExp = createChart(
							canvasExp.getContext('2d'),
							'doughnut',
							expData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'investment':
					expDataArray[6] = expDataArray[6] + parseFloat(inputValueExp.slice(1))
					amountInputExpPlace.value = ''
					modalExp.style.display = 'none'
					if (reportChartExp) {
						reportChartExp.destroy()
					}
					if (canvasExp.style.display == 'block') {
						reportChartExp = createChart(
							canvasExp.getContext('2d'),
							'doughnut',
							expData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
				case 'otherExp':
					expDataArray[7] = expDataArray[7] + parseFloat(inputValueExp.slice(1))
					amountInputExpPlace.value = ''
					modalExp.style.display = 'none'
					if (reportChartExp) {
						reportChartExp.destroy()
					}
					if (canvasExp.style.display == 'block') {
						reportChartExp = createChart(
							canvasExp.getContext('2d'),
							'doughnut',
							expData,
							chartOptions
						)
					}
					updateBalance(getIncSum(), getExpSum())
					break
			}
			uploadingData()
		}
	}
	// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
	async function checkAuth() {
            try {
                const response = await fetch('/auth', {
                  method: 'GET',
                  credentials: 'include', // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ cookies
                });

                if (response.ok) {
                  const data = await response.json();
                  console.log('User is authenticated:', data.token);
                  // –õ–æ–≥–∏–∫–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                  await downloadData()
				  updateBalance(getIncSum(), getExpSum())
                } else {
                  console.log('User is not authenticated');
                  // –õ–æ–≥–∏–∫–∞ –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
				  window.location.href = '/singInPage.html';
                  
                }
              } catch (err) {
                console.error('Error during authentication check:', err);
              }
            }

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
	document.addEventListener('DOMContentLoaded', checkAuth);
	function getIncSum(incSum, expSum) {
		return incDataArray.reduce((partialSum, a) => partialSum + a, 0)
	}

	function getExpSum(incSum, expSum) {
		return expDataArray.reduce((partialSum, a) => partialSum + a, 0)
	}

	function updateBalance(incSum, expSum) {
		var sumTextHolder = document.getElementById('balance')
		var balanceResult = incSum - expSum
		sumTextHolder.textContent = '‚ÇΩ' + balanceResult
	}
	
</script>
